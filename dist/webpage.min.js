let alts="AȦẠA BḂḄB CĊC DḊḌD EĖẸE FḞF GĠG HḢḤH IİỊI JJ KḲK LĿḶL MṀṂM NṄṆN OȮỌO PṖP QQ RṘṚR SṠṢS TṪṬT UỤU VṾV WẆẈW XẊX YẎỴY ZŻẒZ aȧạa bḃḅb cċc dḋḍd eėẹe fḟf gġg hḣḥh iıịi jj kḳk lŀḷl mṁṃm nṅṇn oȯọo pṗp qq rṙṛr sṡṣs tṫ\tṭt uụu vṿv wẇẉw xẋx yẏỵy zżẓz 0⁰₀0 1¹₁1 2²₂2 3³₃3 4⁴₄4 5⁵₅5 6⁶₆6 7⁷₇7 8⁸₈8 9⁹₉9 +⁺₊+ -⁻₋- (⁽₍( )⁾₎) /⅟¼½¾/ =≈≠≡≢= <≤< >≥> &∧& |∨| ?¿? \"“”„‟\" '‼…' {‹{ }›} [«[ ]»] \n¶\n";function tab(t,e=0,a=t.length,r=!1){let o=t.slice(e,a);return o=!0===r?o.replace(/[^\n -~]/g,function(t){let e=alts.split(" ").find(e=>e.includes(t));return e?e[0]:t}):o.replace(/[^ ]/g,function(t){let e=alts.indexOf(t);return e<0?t:alts[e+1]}),t.slice(0,e)+o+t.slice(a)}let numArguments=0;function removeArgument(t){$("#argument-"+t).remove();for(let e=t+1;e<=numArguments;e++){let t=$("#argument-"+e);$(t.children()[0]).attr("placeholder","Argument "+(e-1)+" goes here..."),t.attr("id","argument-"+(e-1))}0===(numArguments-=1)&&$("#argument-0").removeClass("hidden")}function addArgument(t,e=""){for(let e=numArguments;e>t;e--){let t=$("#argument-"+e);$(t.children()[0]).attr("placeholder","Argument "+(e+1)+" goes here..."),t.attr("id","argument-"+(e+1))}let a=$("#argument-template").clone(),r=$(a.children()[0]);a.attr("id","argument-"+(t+1)),r.attr("placeholder","Argument "+(t+1)+" goes here..."),r.val(e),a.removeClass("hidden"),a.insertAfter($("#argument-"+t)),0===numArguments&&$("#argument-0").addClass("hidden"),numArguments+=1}function setVal(t,e){$(t).val(e),$(t).get()[0].adjustHeight()}function tryTranspile(t){if("object"!=typeof Japt){let t=new Error("Could not find Japt object.");throw $("#status").css("color","red"),$("#status").text("Compilation error: "+t.message),t}let e="error";try{setVal("#js-code",e=Japt.transpile(t))}catch(t){throw $("#status").css("color","red"),$("#status").text("Compilation error: "+t.message),t}return e}let v=(new Date).toISOString().slice(0,16),realv;function runJapt(code_Japt,args,input){if(clearTimeout(timeoutID),$("#output").val(""),$("#status").css("color","black"),$("#status").text("Compiling..."),"undefined"==typeof Japt)return $("#status").css("color","red"),void $("#status").text("Could not find Japt code.");let code_JS=tryTranspile(code_Japt);if($("#status").text("Running..."),window.Worker){let t=new Worker("src/worker.js");t.onmessage=function({data:t}){console.log(t),"finished"===t.status?(setVal("#output",t.result),$("#status").text("Finished.")):"error"===t.status&&($("#status").css("color","red"),$("#status").text(t.error))},t.postMessage({code:code_JS,args:args,input:input,env:{A:10}})}else{let program;try{program=eval(code_JS)}catch(t){$("#status").css("color","red"),$("#status").text(t.toString())}try{setVal("#output",program(input,...args)),$("#status").text("Finished.")}catch(t){$("#status").css("color","red"),$("#status").text(t.toString())}}}function run(){let code=$("#code").val(),input=$("#input").val(),rawargs=[],args=[];for(let elem of $("textarea.argument")){if(""===$(elem).attr("placeholder"))continue;let text=elem.value;rawargs.push(text);try{text=eval(text)}catch(t){}args.push(text)}let queryString="";queryString+="?v="+v,queryString+="&code="+escapedBtoA(code),queryString+="&args="+escapedBtoA(JSON.stringify(rawargs)),queryString+="&input="+escapedBtoA(input),history.replaceState(null,"Japt 2 interface",location.origin+location.pathname+queryString),runJapt(code,args,input)}function escapedBtoA(t){return btoa(t.replace(/[^]/g,function(t){return"\\"===t?"\\\\":t.charCodeAt(0)<256?t:"\\u"+t.charCodeAt(0).toString(16).padStart(4,"0")}))}function escapedAtoB(t){return atob(t).replace(/\\u[0-9A-Fa-f]{4}/g,t=>String.fromCharCode(parseInt(t.slice(2),16))).replace(/\\\\/g,"\\")}let timeoutID=-1;for(let t of $("textarea"))t.oninput=t.adjustHeight=function(){let e=parseInt($(t).css("lineHeight")),a=t.value.split("\n").length;a=Math.max(a,$(t).hasClass("argument")?1:2);let r=Math.min(e*a+6,120);t.style.height=r+"px"},t.adjustHeight();$(document).delegate("#code","keydown",function(t){if(9===(t.keyCode||t.which)){t.preventDefault();let e=this.selectionStart,a=this.selectionEnd,r=$(this).val();e===a?$(this).val(tab(r,e-1,e,t.shiftKey)):$(this).val(tab(r,e,a,t.shiftKey)),this.selectionStart=e,this.selectionEnd=a}clearTimeout(timeoutID),timeoutID=setTimeout(function(){setVal("#js-code",tryTranspile($("#code").val()))},1e3)});{let code,args,input,queries=location.search.match(/[&?][^&?=]+=[^&?]+/g)||[];for(let item of queries){let key=item.slice(1,item.indexOf("=")),val=item.slice(item.indexOf("=")+1);"code"===key?code=escapedAtoB(val):"input"===key?input=escapedAtoB(val):"args"===key?args=eval(escapedAtoB(val)):"v"===key&&(v=val)}code&&!$("#code").val()&&$("#code").val(code),input&&!$("#input").val()&&$("#input").val(input),args&&0!==args.length||(args=[""]),"dev"!==v&&"master"!==v||(v+="@{"+(new Date).toISOString().slice(0,16)+"}");for(let t=0;t<args.length;t++)addArgument(t,args[t]);realv=/^\d{4}-/.test(v)?"@{"+v+"Z}":/^\d\./.test(v)?"v"+v:v,ajaxGlobalThenLocal("src/japt.js",(t,e)=>console.log("Loaded Japt 2",e?"version "+v:"latest version"),{dataType:"script"}),ajaxGlobalThenLocal("docs/methods.txt",methodsTable)}function ajaxGlobalThenLocal(t,e,a){$.ajax("https://rawgit.com/ETHproductions/japt-2/"+realv+"/"+t,a).done(t=>e(t,!0)).fail(()=>$.ajax(t,a).done(t=>e(t,!1)).fail(()=>{throw new Error("Could not find "+t)}))}function methodsTable(t,e){e||console.log("Failed to load past version of methods table from GitHub; current version loaded instead.");$("#table-methods");let a,r=t.split(/\n/);for(let t=0;t<r.length;t++){let e=r[t];if(!/^.\... /.test(e))continue;let[o,n,s]=e.split(/\s+\|\s+/),l="<tr>";a!==o&&(l+="<th scope='row' rowspan="+r.slice(t).findIndex(t=>0!==t.indexOf(o+" "))+">"+o.slice(0,2)+"<code>"+o.slice(2)+"</code></th>"),l+="<td><code>"+n+"</code></td>",l+="<td>"+s.replace(/(`{1,3})((?:.(?!\1))*[^`])\1/g,"<code>$2</code>")+"</td>",l+="</tr>",$("#table-methods").append(l),a=o}}